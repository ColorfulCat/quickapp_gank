"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function a(u,o){try{var n=r[u](o),i=n.value}catch(e){return void t(e)}if(!n.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}return a("next")})}}function applyRouter(e){e.use(_routes2.default.redirectHtmlReq),e.use((0,_koaStatic2.default)(_env.webAppEnv.WEB_APP_ROOT));var r=new _koaRouter2.default;return r.post(_apiDef2.default.index,(0,_koaBody2.default)(),_routes2.default.adapterForBackwardComp),r.post(_apiDef2.default.appRegister,(0,_koaBody2.default)(),_routes2.default.appRegister),r.post(_apiDef2.default.startDebug,(0,_koaBody2.default)(),_routes2.default.startDebug),r}Object.defineProperty(exports,"__esModule",{value:!0});var beforeStart=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_service.prepareStartServer)();case 2:return e.next=4,(0,_wsserver.createSocketServer)(r,t);case 4:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}(),_koaRouter=require("koa-router"),_koaRouter2=_interopRequireDefault(_koaRouter),_koaBody=require("koa-body"),_koaBody2=_interopRequireDefault(_koaBody),_koaStatic=require("koa-static"),_koaStatic2=_interopRequireDefault(_koaStatic),_env=require("../env"),_apiDef=require("./apiDef"),_apiDef2=_interopRequireDefault(_apiDef),_routes=require("./routes"),_routes2=_interopRequireDefault(_routes),_service=require("./service"),_wsserver=require("./wsserver");exports.default={name:"debug",applyRouter:applyRouter,beforeStart:beforeStart};